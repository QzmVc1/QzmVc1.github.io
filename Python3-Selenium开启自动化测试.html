<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="mask-icon" href="/images/favicon.png" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic%7CRoboto+Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-fill-left.css">
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"qzmvc1.top","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.8.0","exturl":false,"sidebar":{"position":"left","width":310,"display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"manual"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"utterances","storage":true,"lazyload":false,"nav":null,"activeClass":"utterances"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>


<meta name="description" content="一、Selenium简介Selenium是一款适用于Web应用程序的便携式软件测试框架。 Selenium为编写测试提供了一个回放工具，无需学习测试脚本语言。它还提供了一种测试领域特定的语言，用于编写包括C＃，Groovy，Java，Perl，PHP，Python，Ruby和Scala等多种流行编程语言的测试。 Selenium官网地址 环境配置： 系统：windows10浏览器：Chrome 7">
<meta property="og:type" content="article">
<meta property="og:title" content="Python3-Selenium开启自动化测试">
<meta property="og:url" content="http://qzmvc1.top/Python3-Selenium%E5%BC%80%E5%90%AF%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95.html">
<meta property="og:site_name" content="QzmVc1">
<meta property="og:description" content="一、Selenium简介Selenium是一款适用于Web应用程序的便携式软件测试框架。 Selenium为编写测试提供了一个回放工具，无需学习测试脚本语言。它还提供了一种测试领域特定的语言，用于编写包括C＃，Groovy，Java，Perl，PHP，Python，Ruby和Scala等多种流行编程语言的测试。 Selenium官网地址 环境配置： 系统：windows10浏览器：Chrome 7">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/03/kLwAfI.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/03/kLys9H.png">
<meta property="article:published_time" content="2019-03-03T06:05:37.000Z">
<meta property="article:modified_time" content="2021-10-06T11:54:58.000Z">
<meta property="article:author" content="QzmVc1">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Selenium">
<meta property="article:tag" content="Modules">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.ax1x.com/2019/03/03/kLwAfI.png">


<link rel="canonical" href="http://qzmvc1.top/Python3-Selenium%E5%BC%80%E5%90%AF%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://qzmvc1.top/Python3-Selenium%E5%BC%80%E5%90%AF%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95.html","path":"Python3-Selenium开启自动化测试.html","title":"Python3-Selenium开启自动化测试"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>

<script>
    (function(){
        if(''){
            if (prompt('加密文，来试试你的运气吧！') !== ''){
                alert('要不要再尝试一次呢~~');
                history.back();
            }
        }
    })();
</script><title>Python3-Selenium开启自动化测试 | QzmVc1</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">QzmVc1</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Standing on Shoulders of Giants.</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E3%80%81Selenium%E7%AE%80%E4%BB%8B"><span class="nav-text">一、Selenium简介</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%EF%BC%9A"><span class="nav-text">环境配置：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E3%80%81Selenium%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E6%B5%8B%E8%AF%95"><span class="nav-text">二、Selenium的安装与测试</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-Selenium%E5%AE%89%E8%A3%85"><span class="nav-text">2.1 Selenium安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-%E6%B5%8F%E8%A7%88%E5%99%A8%E9%A9%B1%E5%8A%A8driver%E5%AE%89%E8%A3%85"><span class="nav-text">2.2 浏览器驱动driver安装</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-2-1-%E6%B5%8F%E8%A7%88%E5%99%A8%E9%A9%B1%E5%8A%A8driver%E7%9A%84%E4%B8%8B%E8%BD%BD"><span class="nav-text">2.2.1 浏览器驱动driver的下载</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-2-2-%E6%B5%8F%E8%A7%88%E5%99%A8%E9%A9%B1%E5%8A%A8driver%E7%9A%84%E5%AE%89%E8%A3%85"><span class="nav-text">2.2.2 浏览器驱动driver的安装</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-%E6%B5%8B%E8%AF%95%E9%A9%B1%E5%8A%A8%E6%B5%8F%E8%A7%88%E5%99%A8"><span class="nav-text">2.3 测试驱动浏览器</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E7%AA%97%E5%8F%A3%E5%B0%BA%E5%AF%B8%E8%AE%BE%E7%BD%AE%E3%80%81%E7%BD%91%E9%A1%B5%E6%88%AA%E5%9B%BE%E3%80%81%E5%88%B7%E6%96%B0%E3%80%81%E5%89%8D%E8%BF%9B%E5%92%8C%E5%90%8E%E9%80%80"><span class="nav-text">三、窗口尺寸设置、网页截图、刷新、前进和后退</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-%E7%AA%97%E5%8F%A3%E5%B0%BA%E5%AF%B8%E8%AE%BE%E7%BD%AE"><span class="nav-text">3.1 窗口尺寸设置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-%E7%BD%91%E9%A1%B5%E6%88%AA%E5%9B%BE"><span class="nav-text">3.2 网页截图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-%E5%88%B7%E6%96%B0%E3%80%81%E5%89%8D%E8%BF%9B%E5%92%8C%E5%90%8E%E9%80%80"><span class="nav-text">3.3 刷新、前进和后退</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E5%AE%9A%E4%BD%8D%E5%85%83%E7%B4%A0"><span class="nav-text">四、定位元素</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E5%AF%B9%E5%AE%9A%E4%BD%8D%E5%88%B0%E7%9A%84%E5%85%83%E7%B4%A0%E8%BF%9B%E8%A1%8C%E6%93%8D%E4%BD%9C"><span class="nav-text">五、对定位到的元素进行操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-%E8%BE%93%E5%85%A5%E5%92%8C%E7%82%B9%E5%87%BB"><span class="nav-text">5.1 输入和点击</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E5%B1%9E%E6%80%A7"><span class="nav-text">5.2 获取元素属性</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AD%E3%80%81%E9%94%AE%E7%9B%98%E5%92%8C%E9%BC%A0%E6%A0%87%E6%A8%A1%E6%8B%9F"><span class="nav-text">六、键盘和鼠标模拟</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-1-%E9%94%AE%E7%9B%98%E4%BA%8B%E4%BB%B6"><span class="nav-text">6.1 键盘事件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-%E9%BC%A0%E6%A0%87%E4%BA%8B%E4%BB%B6"><span class="nav-text">6.2 鼠标事件</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A%E5%8F%AF%E4%BB%A5%E5%86%99%E4%B8%80%E9%95%BF%E4%B8%B2"><span class="nav-text">方法一：可以写一长串</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A%E5%8F%AF%E4%BB%A5%E5%88%86%E5%87%A0%E6%AD%A5%E5%86%99"><span class="nav-text">方法二：可以分几步写</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%83%E3%80%81%E4%B8%8B%E6%8B%89%E6%A1%86%E5%92%8C%E5%BC%B9%E7%AA%97"><span class="nav-text">七、下拉框和弹窗</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#7-1-%E4%B8%8B%E6%8B%89%E6%A1%86"><span class="nav-text">7.1 下拉框</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#7-1-1-%E9%A6%96%E5%85%88%E5%AF%BC%E5%85%A5Select%E6%A8%A1%E5%9D%97%EF%BC%9A"><span class="nav-text">7.1.1 首先导入Select模块：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#7-1-2-Select%E6%8F%90%E4%BE%9B%E4%BA%86%E4%B8%89%E7%A7%8D%E9%80%89%E6%8B%A9%E6%9F%90%E4%B8%80%E9%A1%B9%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-text">7.1.2 Select提供了三种选择某一项的方法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#7-1-3-Select%E6%8F%90%E4%BE%9B%E4%BA%86%E4%B8%89%E7%A7%8D%E8%BF%94%E5%9B%9Eoptions%E4%BF%A1%E6%81%AF%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-text">7.1.3 Select提供了三种返回options信息的方法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#7-1-4-Select%E6%8F%90%E4%BE%9B%E4%BA%86%E5%9B%9B%E7%A7%8D%E5%8F%96%E6%B6%88%E9%80%89%E4%B8%AD%E9%A1%B9%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-text">7.1.4 Select提供了四种取消选中项的方法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#7-1-5-%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B"><span class="nav-text">7.1.5 代码示例</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-%E5%BC%B9%E7%AA%97"><span class="nav-text">7.2 弹窗</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AB%E3%80%81%E7%AD%89%E5%BE%85%E6%96%B9%E5%BC%8F"><span class="nav-text">八、等待方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#8-1-%E6%98%BE%E5%BC%8F%E7%AD%89%E5%BE%85"><span class="nav-text">8.1 显式等待</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-2-%E9%9A%90%E5%BC%8F%E7%AD%89%E5%BE%85"><span class="nav-text">8.2 隐式等待</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%9D%E3%80%81iframe%E5%88%87%E6%8D%A2"><span class="nav-text">九、iframe切换</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="QzmVc1"
      src="/images/touxiang.jpg">
  <p class="site-author-name" itemprop="name">QzmVc1</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">88</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">43</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="mailto:qzmvc1@gmail.com" title="E-Mail → mailto:qzmvc1@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
      友情链接
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://jcoffeezph.top/" title="https:&#x2F;&#x2F;jcoffeezph.top&#x2F;" rel="noopener" target="_blank">ForMe</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://szd0319.github.io/" title="https:&#x2F;&#x2F;szd0319.github.io&#x2F;" rel="noopener" target="_blank">Silence</a>
        </li>
    </ul>
  </div>

        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://qzmvc1.top/Python3-Selenium%E5%BC%80%E5%90%AF%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/touxiang.jpg">
      <meta itemprop="name" content="QzmVc1">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QzmVc1">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Python3-Selenium开启自动化测试
        </h1>

        <div class="post-meta-container">

          <div class="post-meta">
  
	
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-03-03 14:05:37" itemprop="dateCreated datePublished" datetime="2019-03-03T14:05:37+08:00">2019-03-03</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-10-06 19:54:58" itemprop="dateModified" datetime="2021-10-06T19:54:58+08:00">2021-10-06</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Python%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">Python库</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>9.5k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>9 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h3 id="一、Selenium简介"><a href="#一、Selenium简介" class="headerlink" title="一、Selenium简介"></a>一、Selenium简介</h3><p>Selenium是一款适用于Web应用程序的便携式软件测试框架。 Selenium为编写测试提供了一个回放工具，无需学习测试脚本语言。它还提供了一种测试领域特定的语言，用于编写包括C＃，Groovy，Java，Perl，PHP，Python，Ruby和Scala等多种流行编程语言的测试。</p>
<p><a target="_blank" rel="noopener" href="https://www.seleniumhq.org/">Selenium官网地址</a></p>
<h5 id="环境配置："><a href="#环境配置：" class="headerlink" title="环境配置："></a>环境配置：</h5><blockquote>
<p>系统：windows10<br>浏览器：Chrome 70.0.3538.110<br>Python: 3.7.0<br>Selenium: 3.141.0</p>
</blockquote>
<span id="more"></span>
<hr>
<h3 id="二、Selenium的安装与测试"><a href="#二、Selenium的安装与测试" class="headerlink" title="二、Selenium的安装与测试"></a>二、Selenium的安装与测试</h3><h4 id="2-1-Selenium安装"><a href="#2-1-Selenium安装" class="headerlink" title="2.1 Selenium安装"></a>2.1 Selenium安装</h4><p>使用Python可直接利用pip进行安装selenium</p>
<blockquote>
<p>pip install selenium</p>
</blockquote>
<h4 id="2-2-浏览器驱动driver安装"><a href="#2-2-浏览器驱动driver安装" class="headerlink" title="2.2 浏览器驱动driver安装"></a>2.2 浏览器驱动driver安装</h4><h5 id="2-2-1-浏览器驱动driver的下载"><a href="#2-2-1-浏览器驱动driver的下载" class="headerlink" title="2.2.1 浏览器驱动driver的下载"></a>2.2.1 浏览器驱动driver的下载</h5><ul>
<li>下载地址：<a target="_blank" rel="noopener" href="https://sites.google.com/a/chromium.org/chromedriver/downloads">Google Chrome driver</a></li>
</ul>
<p>注意：driver的下载需要注意对应浏览器的版本</p>
<h5 id="2-2-2-浏览器驱动driver的安装"><a href="#2-2-2-浏览器驱动driver的安装" class="headerlink" title="2.2.2 浏览器驱动driver的安装"></a>2.2.2 浏览器驱动driver的安装</h5><p>下载下来的zip文件解压至python安装目录中，可以放在： <code>C:\Users\Administrator\AppData\Local\Programs\Python\Python37</code>中，但是推荐放置在scripts目录中：<code>C:\Users\Administrator\AppData\Local\Programs\Python\Python37\Scripts</code></p>
<p>完成以上工作，我们就可以进行测试使用selenium驱动浏览器了。</p>
<h4 id="2-3-测试驱动浏览器"><a href="#2-3-测试驱动浏览器" class="headerlink" title="2.3 测试驱动浏览器"></a>2.3 测试驱动浏览器</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line">driver.quit() <span class="comment"># 使用quit()关闭了chrome并结束了此次测试，如果是close()只是关闭chrome，后台仍在进行。</span></span><br></pre></td></tr></table></figure>
<p><img src="https://s2.ax1x.com/2019/03/03/kLwAfI.png" alt=""></p>
<p>看起来正常驱动浏览器并打开了网页，这样我们就完成了selenium自动化测试的准备工作~!</p>
<p>完成环境的安装并测试之后，我们对Selenium有了一定的了解，接下来我们继续驱动浏览器做一些基本操作。</p>
<hr>
<h3 id="三、窗口尺寸设置、网页截图、刷新、前进和后退"><a href="#三、窗口尺寸设置、网页截图、刷新、前进和后退" class="headerlink" title="三、窗口尺寸设置、网页截图、刷新、前进和后退"></a>三、窗口尺寸设置、网页截图、刷新、前进和后退</h3><h4 id="3-1-窗口尺寸设置"><a href="#3-1-窗口尺寸设置" class="headerlink" title="3.1 窗口尺寸设置"></a>3.1 窗口尺寸设置</h4><p>在测试过程中，我们可能会要求打开浏览器的窗口处于最大化或者设置为某一特定尺寸的大小，所以我们使用selenium驱动浏览器时设定窗口大小.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://www.baidu.com&quot;</span>)</span><br><span class="line"></span><br><span class="line">size = driver.get_window_size()    <span class="comment"># 获取窗口尺寸</span></span><br><span class="line"></span><br><span class="line">driver.set_window_size(<span class="number">800</span>,<span class="number">600</span>)    <span class="comment"># 设置窗口尺寸</span></span><br><span class="line"></span><br><span class="line">driver.minimize_window()           <span class="comment"># 最小化窗口</span></span><br><span class="line"></span><br><span class="line">driver.maximize_window()           <span class="comment"># 最大化窗口</span></span><br></pre></td></tr></table></figure></p>
<h4 id="3-2-网页截图"><a href="#3-2-网页截图" class="headerlink" title="3.2 网页截图"></a>3.2 网页截图</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.get_screenshot_as_file(<span class="string">u&#x27;D:\\xxx.png&#x27;</span>)  <span class="comment"># 前缀u解决编码问题</span></span><br></pre></td></tr></table></figure>
<h4 id="3-3-刷新、前进和后退"><a href="#3-3-刷新、前进和后退" class="headerlink" title="3.3 刷新、前进和后退"></a>3.3 刷新、前进和后退</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">driver.get(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line">driver.get(<span class="string">&quot;https://www.google.com&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行后退、前进操作</span></span><br><span class="line">driver.back()    <span class="comment"># 后退</span></span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line">driver.forward() <span class="comment"># 前进</span></span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line">driver.refresh() <span class="comment"># 对网页进行刷新</span></span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="四、定位元素"><a href="#四、定位元素" class="headerlink" title="四、定位元素"></a>四、定位元素</h4><p>selenium提供了多种方式进行定位元素：<code>find_element_by_* </code><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">find_element_by_id</span><br><span class="line">find_element_by_name</span><br><span class="line">find_element_by_xpath</span><br><span class="line">find_element_by_link_text</span><br><span class="line">find_element_by_partial_link_text</span><br><span class="line">find_element_by_tag_name</span><br><span class="line">find_element_by_class_name</span><br><span class="line">find_element_by_css_selector</span><br></pre></td></tr></table></figure><br>当然也可以一次定位多个元素：<code>find_elements_by_* </code><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">find_elements_by_name</span><br><span class="line">find_elements_by_xpath</span><br><span class="line">find_elements_by_link_text</span><br><span class="line">find_elements_by_partial_link_text</span><br><span class="line">find_elements_by_tag_name</span><br><span class="line">find_elements_by_class_name</span><br><span class="line">find_elements_by_css_selector</span><br></pre></td></tr></table></figure><br>因为id是唯一的，所以一次定位多个元素是没有办法通过id进行定位的。</p>
<hr>
<h3 id="五、对定位到的元素进行操作"><a href="#五、对定位到的元素进行操作" class="headerlink" title="五、对定位到的元素进行操作"></a>五、对定位到的元素进行操作</h3><p>我们通过<code>find_element_by_xpath</code>等一系列定位元素的方法获取到网页元素(文本框、按钮等)后，我们可以通过一些函数来对元素进行操作。</p>
<h4 id="5-1-输入和点击"><a href="#5-1-输入和点击" class="headerlink" title="5.1 输入和点击"></a>5.1 输入和点击</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">driver.find_element_by_xpath(<span class="string">&#x27;&#x27;</span>).clear() <span class="comment"># 清空文本框内容</span></span><br><span class="line">driver.find_element_by_xpath(<span class="string">&#x27;&#x27;</span>).send_keys() <span class="comment"># 向文本框中输入内容</span></span><br><span class="line">driver.find_element_by_xpath(<span class="string">&#x27;&#x27;</span>).click() <span class="comment"># 鼠标单击操作</span></span><br><span class="line">driver.find_element_by_xpath(<span class="string">&#x27;&#x27;</span>).submit() <span class="comment"># 对信息进行提交，相当于回车</span></span><br><span class="line"><span class="comment"># submit()要求提交对象是一个表单，click()更强调事件的独立性</span></span><br></pre></td></tr></table></figure>
<h4 id="5-2-获取元素属性"><a href="#5-2-获取元素属性" class="headerlink" title="5.2 获取元素属性"></a>5.2 获取元素属性</h4><p>通过定位元素位置后，就可以获得元素的诸多属性信息，当然是源代码中元素属性存在的情况下。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://qzmvc1.top/&quot;</span>)</span><br><span class="line"></span><br><span class="line">a1 = driver.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;post-进击数据挖掘十大算法-四-C4-5决策树&quot;]/div/header/h1/a&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a1)</span><br><span class="line"><span class="built_in">print</span>(a1.get_attribute(<span class="string">&#x27;href&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(a1.text)</span><br><span class="line"><span class="built_in">print</span>(a1.tag_name)</span><br><span class="line"><span class="built_in">print</span>(a1.size)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>
<p><img src="https://s2.ax1x.com/2019/03/03/kLys9H.png" alt=""><br>在上述代码中，依次通过 <code>.get_attribute(‘href’)</code>、 <code>element.text</code>、<code>element.tag_name</code>、 <code>element.size</code>获得了属性值href、元素文本内容、元素标签名、元素尺寸这些常用的方法。</p>
<hr>
<h3 id="六、键盘和鼠标模拟"><a href="#六、键盘和鼠标模拟" class="headerlink" title="六、键盘和鼠标模拟"></a>六、键盘和鼠标模拟</h3><h4 id="6-1-键盘事件"><a href="#6-1-键盘事件" class="headerlink" title="6.1 键盘事件"></a>6.1 键盘事件</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.keys <span class="keyword">import</span> Keys</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例</span></span><br><span class="line">driver.find_element_by_xpath(<span class="string">&#x27;xxx&#x27;</span>).send_keys(Keys.BACK_SPACE)  <span class="comment"># 利用backspace键删除字符串最后一位</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">send_keys(Keys.BACK_SPACE) 删除键（BackSpace）</span><br><span class="line"></span><br><span class="line">send_keys(Keys.SPACE) 空格键(Space)</span><br><span class="line"></span><br><span class="line">send_keys(Keys.TAB) 制表键(Tab)</span><br><span class="line"></span><br><span class="line">send_keys(Keys.ESCAPE) 回退键（Esc）</span><br><span class="line"></span><br><span class="line">send_keys(Keys.ENTER) 回车键（Enter）</span><br><span class="line"></span><br><span class="line">send_keys(Keys.CONTROL, <span class="string">&#x27;a&#x27;</span>) 全选（Ctrl+A）</span><br><span class="line"></span><br><span class="line">send_keys(Keys.CONTROL, <span class="string">&#x27;c&#x27;</span>) 复制（Ctrl+C）</span><br><span class="line"></span><br><span class="line">send_keys(Keys.CONTROL, <span class="string">&#x27;x&#x27;</span>) 剪切（Ctrl+X）</span><br><span class="line"></span><br><span class="line">send_keys(Keys.CONTROL, <span class="string">&#x27;v&#x27;</span>) 粘贴（Ctrl+V）</span><br><span class="line"></span><br><span class="line">send_keys(Keys.F1) 键盘 F1</span><br><span class="line">...</span><br><span class="line">send_keys(Keys.F12) 键盘 F12</span><br></pre></td></tr></table></figure>
<h4 id="6-2-鼠标事件"><a href="#6-2-鼠标事件" class="headerlink" title="6.2 鼠标事件"></a>6.2 鼠标事件</h4><p>ActionChains是一种自动执行低级别交互的方法，例如鼠标移动，鼠标按钮操作，按键和上下文菜单交互。这对于执行更复杂的操作非常有用，例如悬停和拖放。</p>
<ul>
<li>在ActionChains对象上调用操作方法时，操作将存储在ActionChains对象的队列中。</li>
<li><p>当调用perform()时，事件将按它们排队的<strong>顺序触发</strong>。</p>
<p>ActionChains可以用于<strong>链式</strong>或者可以将操作逐个排队，然后执行。</p>
</li>
</ul>
<p>无论哪种方式，动作都按照它们被调用的顺序执行，一个在另一个之后执行。</p>
<p>这里还是以代码展示部分功能吧：</p>
<h6 id="方法一：可以写一长串"><a href="#方法一：可以写一长串" class="headerlink" title="方法一：可以写一长串"></a>方法一：可以写一长串</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver.common.action_chains <span class="keyword">import</span> ActionChains</span><br><span class="line"></span><br><span class="line">menu = driver.find_element_by_css_selector(<span class="string">&quot;.nav&quot;</span>)</span><br><span class="line">hidden_submenu = driver.find_element_by_css_selector(<span class="string">&quot;.nav #submenu1&quot;</span>)</span><br><span class="line">ActionChains(driver).move_to_element(menu).click(hidden_submenu).perform()</span><br></pre></td></tr></table></figure>
<h6 id="方法二：可以分几步写"><a href="#方法二：可以分几步写" class="headerlink" title="方法二：可以分几步写"></a>方法二：可以分几步写</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">menu = driver.find_element_by_css_selector(<span class="string">&quot;.nav&quot;</span>)</span><br><span class="line">hidden_submenu = driver.find_element_by_css_selector(<span class="string">&quot;.nav #submenu1&quot;</span>)</span><br><span class="line">actions = ActionChains(driver)</span><br><span class="line">actions.move_to_element(menu)</span><br><span class="line">actions.click(hidden_submenu)</span><br><span class="line">actions.perform()</span><br></pre></td></tr></table></figure>
<p>其他操作如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">click(on_element=<span class="literal">None</span>) ——单击鼠标左键</span><br><span class="line"></span><br><span class="line">click_and_hold(on_element=<span class="literal">None</span>) ——点击鼠标左键，不松开</span><br><span class="line"></span><br><span class="line">context_click(on_element=<span class="literal">None</span>) ——点击鼠标右键</span><br><span class="line"></span><br><span class="line">double_click(on_element=<span class="literal">None</span>) ——双击鼠标左键</span><br><span class="line"></span><br><span class="line">drag_and_drop(source, target) ——拖拽到某个元素然后松开</span><br><span class="line"></span><br><span class="line">drag_and_drop_by_offset(source, xoffset, yoffset) ——拖拽到某个坐标然后松开</span><br><span class="line"></span><br><span class="line">key_down(value, element=<span class="literal">None</span>) ——按下某个键盘上的键</span><br><span class="line"></span><br><span class="line">key_up(value, element=<span class="literal">None</span>) ——松开某个键</span><br><span class="line"></span><br><span class="line">move_by_offset(xoffset, yoffset) ——鼠标从当前位置移动到某个坐标</span><br><span class="line"></span><br><span class="line">move_to_element(to_element) ——鼠标移动到某个元素</span><br><span class="line"></span><br><span class="line">move_to_element_with_offset(to_element, xoffset, yoffset) ——移动到距某个元素（左上角坐标）多少距离的位置</span><br><span class="line"></span><br><span class="line">perform() ——执行链中的所有动作</span><br><span class="line"></span><br><span class="line">release(on_element=<span class="literal">None</span>) ——在某个元素位置松开鼠标左键</span><br><span class="line"></span><br><span class="line">send_keys(*keys_to_send) ——发送某个键到当前焦点的元素</span><br><span class="line"></span><br><span class="line">send_keys_to_element(element, *keys_to_send) ——发送某个键到指定元素</span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="七、下拉框和弹窗"><a href="#七、下拉框和弹窗" class="headerlink" title="七、下拉框和弹窗"></a>七、下拉框和弹窗</h3><h4 id="7-1-下拉框"><a href="#7-1-下拉框" class="headerlink" title="7.1 下拉框"></a>7.1 下拉框</h4><h5 id="7-1-1-首先导入Select模块："><a href="#7-1-1-首先导入Select模块：" class="headerlink" title="7.1.1 首先导入Select模块："></a>7.1.1 首先导入Select模块：</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.select <span class="keyword">import</span> Select</span><br></pre></td></tr></table></figure>
<h5 id="7-1-2-Select提供了三种选择某一项的方法"><a href="#7-1-2-Select提供了三种选择某一项的方法" class="headerlink" title="7.1.2 Select提供了三种选择某一项的方法"></a>7.1.2 Select提供了三种选择某一项的方法</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> select_by_index          <span class="comment"># 通过索引定位</span></span><br><span class="line"><span class="number">2</span> select_by_value          <span class="comment"># 通过value值定位</span></span><br><span class="line"><span class="number">3</span> select_by_visible_text   <span class="comment"># 通过文本值定位</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意事项：</p>
<p>index索引是从“0”开始；</p>
<p>value是option标签的一个属性值，并不是显示在下拉框中的值；</p>
<p>visible_text是在option标签中间的值，是显示在下拉框的值；</p>
</blockquote>
<h5 id="7-1-3-Select提供了三种返回options信息的方法"><a href="#7-1-3-Select提供了三种返回options信息的方法" class="headerlink" title="7.1.3 Select提供了三种返回options信息的方法"></a>7.1.3 Select提供了三种返回options信息的方法</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> options                  <span class="comment"># 返回select元素所有的options</span></span><br><span class="line"><span class="number">2</span> all_selected_options     <span class="comment"># 返回select元素中所有已选中的选项</span></span><br><span class="line"><span class="number">3</span> first_selected_options   <span class="comment"># 返回select元素中选中的第一个选项</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意事项：</p>
<p>这三种方法的作用是查看已选中的元素是否是自己希望选择的：</p>
<p>options：提供所有选项的元素列表；</p>
<p>all_selected_options：提供所有被选中选项的元素列表；</p>
<p>first_selected_option：提供第一个被选中的选项元素；</p>
</blockquote>
<h5 id="7-1-4-Select提供了四种取消选中项的方法"><a href="#7-1-4-Select提供了四种取消选中项的方法" class="headerlink" title="7.1.4 Select提供了四种取消选中项的方法"></a>7.1.4 Select提供了四种取消选中项的方法</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> deselect_all             <span class="comment"># 取消全部的已选择项</span></span><br><span class="line"><span class="number">2</span> deselect_by_index        <span class="comment"># 取消已选中的索引项</span></span><br><span class="line"><span class="number">3</span> deselect_by_value        <span class="comment"># 取消已选中的value值</span></span><br><span class="line"><span class="number">4</span> deselect_by_visible_text <span class="comment"># 取消已选中的文本值</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意事项：</p>
<p>在日常的web测试中，会经常遇到某些下拉框选项已经被默认选中，这种时候就需要用到这里所说的四种方法</p>
</blockquote>
<h5 id="7-1-5-代码示例"><a href="#7-1-5-代码示例" class="headerlink" title="7.1.5 代码示例"></a>7.1.5 代码示例</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.select <span class="keyword">import</span> Select</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据索引选择</span></span><br><span class="line">Select(driver.find_element_by_name(<span class="string">&quot;xxx&quot;</span>)).select_by_index(<span class="string">&quot;xxx&quot;</span>)</span><br><span class="line"><span class="comment"># 根据value值选择</span></span><br><span class="line">Select(driver.find_element_by_name(<span class="string">&quot;xxx&quot;</span>)).select_by_value(<span class="string">&quot;xxx&quot;</span>)</span><br><span class="line"><span class="comment"># 根据文本值选择</span></span><br><span class="line">Select(driver.find_element_by_name(<span class="string">&quot;xxx&quot;</span>)).select_by_visible_text(<span class="string">&quot;xxx&quot;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="7-2-弹窗"><a href="#7-2-弹窗" class="headerlink" title="7.2 弹窗"></a>7.2 弹窗</h4><p>在完成某些操作时会弹出对话框来提示，主要分为”警告消息框”,”确认消息框”,”提示消息对话”三种类型的对话框。</p>
<p>1.警告消息框（alert）<br>　　警告消息框提供了一个”确定”按钮让用户关闭该消息框，并且该消息框是模式对话框，也就是说用户必须先关闭该消息框然后才能继续进行操作。</p>
<p>2.确认消息框（confirm）<br>　　确认消息框向用户提示一个”是与否”问题，用户可以根据选择”确定”按钮和”取消”按钮。</p>
<p>3.提示消息对话（prompt）<br>　　提示消息框提供了一个文本字段，用户可以在此字段输入一个答案来响应您的提示。该消息框有一个”确定”按钮和一个”取消”按钮。选择”确认”会响应对应的提示信息，选择”取消”会关闭对话框。</p>
<p>selenium 提供switch_to.alert()方法定位到 alert/confirm/prompt对话框。使用 text/accept/dismiss/send_keys 进行操作，这里注意的是send_keys只能对prompt进行操作。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">switch_to.alert() 　　<span class="comment">#定位弹出对话</span></span><br><span class="line">text 　　             <span class="comment">#获取对话框文本值</span></span><br><span class="line">accept()              <span class="comment">#相当于点击&quot;确认&quot;</span></span><br><span class="line">dismiss()            <span class="comment">#相当于点击&quot;取消&quot;</span></span><br><span class="line">send_keys()          <span class="comment"># 输入值，只能对prompt使用。</span></span><br><span class="line"></span><br><span class="line">alert = driver.switch_to.alert()</span><br><span class="line">alert.text</span><br><span class="line">alert.accept()</span><br><span class="line">alert.dismiss()</span><br></pre></td></tr></table></figure>
<h3 id="八、等待方式"><a href="#八、等待方式" class="headerlink" title="八、等待方式"></a>八、等待方式</h3><p>在webdriver只有两种类型等待方式，显式等待和隐式等待，之前是在程序运行过程中使用time模块中的sleep进行代码的休眠进行强制等待，是显式等待中的一种极端情况。</p>
<h4 id="8-1-显式等待"><a href="#8-1-显式等待" class="headerlink" title="8.1 显式等待"></a>8.1 显式等待</h4><p>显式等待是你在代码中定义等待一定条件发生后再进一步执行你的代码。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> ctime</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> WebDriverWait</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support <span class="keyword">import</span> expected_conditions <span class="keyword">as</span> EC</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(ctime())</span><br><span class="line">    element = WebDriverWait(dr, <span class="number">10</span>).until(</span><br><span class="line">        EC.presence_of_element_located((By.ID, <span class="string">&quot;kw&quot;</span>))</span><br><span class="line">    )</span><br><span class="line">    <span class="comment"># WebDriverWait(driver=self.driver, timeout=300, poll_frequency=0.5,  ignored_exceptions=None)</span></span><br><span class="line">    <span class="comment"># driver：浏览器驱动</span></span><br><span class="line">    <span class="comment"># timeout：最长超时等待时间</span></span><br><span class="line">    <span class="comment"># poll_frequency：检测的时间间隔，默认为500ms</span></span><br><span class="line">    <span class="comment"># ignore_exception：超时后抛出的异常信息，默认情况下抛出 NoSuchElementException 异常</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我已找到&quot;</span>)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    <span class="built_in">print</span>(ctime())</span><br><span class="line">    driver.quit()</span><br></pre></td></tr></table></figure><br>以上代码执行后就发现，整段代码执行速度非常快，即使我在WebDriverWait中设置10秒，也不会等待10秒的情况，因为在不到一秒内，已经完成了加载并定位id为“kw”的元素。</p>
<p>通过WebDriverWait 和 ExpectedCondition 组合使用，让我们的代码执行只需要等待需要的时长，而不是固定的时长，这样最大限度的节省时间。</p>
<p> 此外ExpectedCondition类中提供了很多预期条件判断方法，省去了再创建包的功夫：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">title_is：判断当前页面的title是否等于预期</span><br><span class="line">title_contains：判断当前页面的title是否包含预期字符串</span><br><span class="line">presence_of_element_located：判断某个元素是否被加到了dom树里，并不代表该元素一定可见</span><br><span class="line">visibility_of_element_located：判断某个元素是否可见. 可见代表元素非隐藏，并且元素的宽和高都不等于0</span><br><span class="line">visibility_of：跟上面的方法做一样的事情，只是上面的方法要传入locator，这个方法直接传定位到的element就好了</span><br><span class="line">presence_of_all_elements_located：判断是否至少有1个元素存在于dom树中。举个例子，如果页面上有n个元素的class都是&#x27;column-md-3&#x27;，那么只要有1个元素存在，这个方法就返回True</span><br><span class="line">text_to_be_present_in_element：判断某个元素中的text是否 包含 了预期的字符串</span><br><span class="line">text_to_be_present_in_element_value：判断某个元素中的value属性是否包含了预期的字符串</span><br><span class="line">frame_to_be_available_and_switch_to_it：判断该frame是否可以switch进去，如果可以的话，返回True并且switch进去，否则返回False</span><br><span class="line">invisibility_of_element_located：判断某个元素中是否不存在于dom树或不可见</span><br><span class="line">element_to_be_clickable - it is Displayed and Enabled：判断某个元素中是否可见并且是enable的，这样的话才叫clickable</span><br><span class="line">staleness_of：等某个元素从dom树中移除，注意，这个方法也是返回True或False</span><br><span class="line">element_to_be_selected：判断某个元素是否被选中了,一般用在下拉列表</span><br><span class="line">element_located_to_be_selected</span><br><span class="line">element_selection_state_to_be：判断某个元素的选中状态是否符合预期</span><br><span class="line">element_located_selection_state_to_be：跟上面的方法作用一样，只是上面的方法传入定位到的element，而这个方法传入locator</span><br><span class="line">alert_is_present：判断页面上是否存在alert</span><br></pre></td></tr></table></figure>
<h4 id="8-2-隐式等待"><a href="#8-2-隐式等待" class="headerlink" title="8.2 隐式等待"></a>8.2 隐式等待</h4><p>隐式等待，就是在创建driver时，为浏览器对象创建一个等待时间，这个方法是得不到某个元素就等待一段时间，直到拿到某个元素位置。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.implicity_wait(<span class="number">10</span>)</span><br></pre></td></tr></table></figure><br>implicity_wait()默认参数的单位为妙，本例中设置等待时长为10秒，首先这10秒并非一个固定的等待时间，它并不影响脚本的执行速度。其次，它并不针对页面上的某一元素进行等待。当脚本执行到某个元素定位是，如果元素可以定位，则继续执行，如果元素定位不到，则它将以轮询的方式不断地判断元素是否被定位到。假设在第六秒定位到了元素则继续执行，若直到超出设置的时长10秒还没有定位到元素，则抛出异常。</p>
<hr>
<h3 id="九、iframe切换"><a href="#九、iframe切换" class="headerlink" title="九、iframe切换"></a>九、iframe切换</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">driver.switch_to.frame(<span class="string">&#x27;&#x27;</span>)                  <span class="comment"># 选择iframe</span></span><br><span class="line">driver.switch_to.default_content()        <span class="comment"># 回到主页面</span></span><br></pre></td></tr></table></figure>
<p>说明：<strong>switch_to_frame接受的参数是iframe的id或者name属性</strong>，如果没有，则可以通过find_element_by_tag_name(‘iframe’)找到iframe，然后作为参数定位。</p>
<hr>
<p>参考链接：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/lvzb86/">https://www.cnblogs.com/lvzb86/</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>觉得本文对你有用的话，不妨打个赏吧~</div>
  <button>
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.jpg" alt="QzmVc1 微信">
        <span>微信</span>
      </div>
      <div>
        <img src="/images/alipay.jpg" alt="QzmVc1 支付宝">
        <span>支付宝</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>QzmVc1
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="http://qzmvc1.top/Python3-Selenium%E5%BC%80%E5%90%AF%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95.html" title="Python3-Selenium开启自动化测试">http://qzmvc1.top/Python3-Selenium开启自动化测试.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Python/" rel="tag"><i class="fa fa-tag"></i> Python</a>
              <a href="/tags/Selenium/" rel="tag"><i class="fa fa-tag"></i> Selenium</a>
              <a href="/tags/Modules/" rel="tag"><i class="fa fa-tag"></i> Modules</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/Numpy_Scipy_Pandas%E5%87%BD%E6%95%B0%E7%94%A8%E6%B3%95%E5%8F%8A%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB-%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0.html" rel="prev" title="Numpy、Scipy、Pandas函数用法及问题汇总(长期更新)">
                  <i class="fa fa-chevron-left"></i> Numpy、Scipy、Pandas函数用法及问题汇总(长期更新)
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/Django%E6%A1%86%E6%9E%B6%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0-%E4%B8%80-%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93.html" rel="next" title="Django框架入门笔记(一):基础总结">
                  Django框架入门笔记(一):基础总结 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>







  <div class="comments" id="comments">
    <script src="https://utteranc.es/client.js"
        repo="QzmVc1/blog-comment"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
    </script>
    <div class="comments utterances-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">QzmVc1</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">455k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">6:54</span>
  </span>
</div>


<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>



<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->



    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/pace.js"></script>

  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>




  <script async src="/js/cursor/fireworks.js"></script>

  
 
	<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
 

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true}});</script></body>
</html>

